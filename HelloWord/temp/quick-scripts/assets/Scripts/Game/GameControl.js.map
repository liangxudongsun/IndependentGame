{"version":3,"sources":["GameControl.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\Scripts\\Game","sourcesContent":["import Hero from './Hero';\r\nimport { Common } from \"./../Tool/Common\";\r\nimport { ConstData } from '../Tool/ConstData';\r\nimport Stick from './Stick';\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class GameControl extends cc.Component\r\n{\r\n    @property(cc.Prefab)\r\n    private heroProfab: cc.Prefab = null;\r\n\r\n    @property(cc.Prefab)\r\n    private stickProfab: cc.Prefab = null;\r\n\r\n    @property(cc.Prefab)\r\n    private blockProfab: cc.Prefab = null;\r\n\r\n    @property(cc.Node)\r\n    private blockGroup:cc.Node = null;\r\n\r\n    //英雄\r\n    private hero: Hero = null;\r\n    //棍子\r\n    private stick: Stick = null;\r\n    \r\n    //方块数组\r\n    @property([cc.Node])\r\n    blockArray:Array<cc.Node> = [];  \r\n    \r\n    onLoad() \r\n    {\r\n        //添加事件\r\n        this.node.on(cc.Node.EventType.MOUSE_DOWN, this.onMouseDown);\r\n        this.node.on(cc.Node.EventType.MOUSE_UP, this.onMouseUp);\r\n    }\r\n\r\n    start()\r\n    {\r\n        this.createHeroAndStick();\r\n    }\r\n\r\n    onDestory()\r\n    {\r\n        this.node.off(cc.Node.EventType.MOUSE_DOWN, this.onMouseDown);\r\n        this.node.off(cc.Node.EventType.MOUSE_UP, this.onMouseUp);\r\n    }\r\n\r\n    private createBlock() \r\n    {\r\n        let block = cc.instantiate(this.blockProfab);\r\n\r\n        this.blockArray.push(block);\r\n        this.blockGroup.addChild(block);\r\n\r\n        let position = Common.GetInstance().GetRandomNumber() - 50 + 960;\r\n        let widthPercent = Common.GetInstance().GetRandomNumber()/100.0;\r\n        if(widthPercent > 0.5)\r\n        {\r\n            widthPercent = 0.5;\r\n        }\r\n        else if(widthPercent < 0.3)\r\n        {\r\n            widthPercent = 0.3;\r\n        }\r\n\r\n        block.setPosition(new cc.Vec2(position,0));\r\n        block.setScale(widthPercent,1);\r\n    }\r\n\r\n    private createHeroAndStick()\r\n    {\r\n        //创建英雄\r\n        this.hero = cc.instantiate(this.heroProfab).getComponent(Hero);\r\n        this.node.addChild(this.hero.node);\r\n        this.hero.node.setPosition(ConstData.HeroStartPos);\r\n        this.hero.setBlockArray(this.blockArray);\r\n\r\n        //创建棍子\r\n        this.stick = cc.instantiate(this.stickProfab).getComponent(Stick);\r\n        this.node.addChild(this.stick.node);\r\n        \r\n        let stickPos =  new cc.Vec2(ConstData.HeroStartPos.x,ConstData.HeroStartPos.y);\r\n        stickPos.x += 10;\r\n\r\n        this.stick.node.setPosition(stickPos);\r\n        this.hero.setStick(this.stick.node);\r\n    }\r\n\r\n    private deleteBlock()\r\n    {\r\n        for (let index = 0; index < this.blockArray.length; index++)\r\n        {\r\n            let element = this.blockArray[index];\r\n            if(element.position.x < 0)\r\n            {\r\n                this.blockArray[index] = null;\r\n                element.removeFromParent(true);\r\n                this.blockArray.shift();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    onMouseDown = function (event: any)\r\n    {\r\n        this.hero.setHeroState(2);\r\n    }.bind(this)\r\n\r\n    onMouseUp = function (event: any)\r\n    {\r\n        let isCanRun = this.hero.setHeroState(3);\r\n        if(isCanRun)\r\n        {\r\n            this.hero.heroRun();\r\n            this.deleteBlock();\r\n            this.createBlock();\r\n        }\r\n    }.bind(this)\r\n}\r\n"]}